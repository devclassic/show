import{r as y,aC as n,X as b,c as l,a as s,b as k,d as i,w as r,t as w,F as L,o as c,e as d}from"./index-DFBKAQJf.js";import{h as u,E as M}from"./http-DSFHMeZK.js";import{M as H}from"./index-BMSQkwth.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={class:"buttons"},C={type:"file",class:"file",ref:"file",accept:"video/mp4"},B={class:"status"},E={key:0,class:"video"},N=["src"],V=["innerHTML"],D=["innerHTML"],F={__name:"Heart",setup(R){const p=H(),t=y({result:"",file:n("file"),video:n("video"),src:"",loading:!1,status:"",suggestion:""});b(()=>{t.file.addEventListener("change",async()=>{if(t.file.files.length===0)return;t.src=URL.createObjectURL(t.file.files[0]),t.loading=!0,t.status="正在分析...";const o=new FormData;o.append("file",t.file.files[0]);let e=await u.post("/api/heart",o),a="";for(const[v,h]of Object.entries(e.data.data))a+=`<span style="color:blue">${v}</span>：<span style="color:red">${h}</span><br>`;t.result=a,t.status="正在生成诊疗建议...";const m=`
      <result>${t.result}</result>
      <result>为心脏超声检测结果，根据超声检测结果，生成诊疗建议。
      `;e=await u.post("/api/form",{prompt:m});const g=e.data.data.replace(/<think>[\s\S]*?<\/think>/g,"");t.suggestion=p.render(g),t.status="",t.loading=!1})});const f=async()=>{t.file.click()},_=()=>{t.file.value=null,t.src="",t.result="",t.suggestion=""};return(o,e)=>{const a=M;return c(),l(L,null,[e[2]||(e[2]=s("div",{class:"title"},"心脏超声",-1)),s("div",x,[s("input",C,null,512),i(a,{type:"primary",loading:t.loading,onClick:f},{default:r(()=>e[0]||(e[0]=[d("上传超声视频")])),_:1,__:[0]},8,["loading"]),i(a,{type:"primary",disabled:t.loading,onClick:_},{default:r(()=>e[1]||(e[1]=[d("重置")])),_:1,__:[1]},8,["disabled"]),s("span",B,w(t.status),1)]),t.src?(c(),l("div",E,[s("video",{ref:"video",src:t.src,controls:"",loop:"",muted:"",autoplay:"",width:"224",height:"224"},null,8,N)])):k("",!0),s("div",{innerHTML:t.result,class:"result"},null,8,V),s("div",{innerHTML:t.suggestion,class:"suggestion"},null,8,D)],64)}}},S=T(F,[["__scopeId","data-v-a51b0cf4"]]);export{S as default};
