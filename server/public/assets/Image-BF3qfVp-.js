import{r as E,aC as b,c as o,a as m,d as n,w as r,F as u,as as p,o as l,G as w,b as g,e as c,J as V,t as F}from"./index-Cd8BDsyL.js";import{E as B,d as I}from"./el-form-item-oa6GKQvK.js";import{E as N}from"./el-input-DPsbHVgQ.js";import{E as D,h as R,a as J}from"./http-DGZGRwHc.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"input"},T={class:"item"},U=["src"],z={class:"result"},A={key:0,class:"msgimg"},G={class:"msgimgitme"},M=["src"],O={__name:"Image",setup(j){const e=E({loading:!1,file:b("file"),files:[],images:[],text:"",messages:[],history:[{role:"user",content:[{type:"text",text:"用中文回答用户问题"}]},{role:"user",content:[{type:"text",text:"你是端点科技医疗影像助手"}]}]});function _(){e.file.click()}function y(){e.images=[],e.files=e.file.files;for(const i of e.files){const t=new FileReader;t.onload=s=>{e.images.push(s.target.result)},t.readAsDataURL(i)}}async function x(){e.loading=!0,e.messages.push({role:"user",images:e.images,content:e.text}),e.images=[];const i=new FormData;for(let s=0;s<e.file.files.length;s++)i.append("files",e.file.files[s]);i.append("text",e.text),i.append("history",JSON.stringify(e.history)),e.text="";const t=await R.post("/api/image",i);e.messages.push({role:"assistant",content:t.data.data.text}),e.history=t.data.data.history,e.loading=!1,e.file.value=""}async function h(){e.messages=[],e.images=[],e.file.value="",e.text="",e.history=[{role:"user",content:[{type:"text",text:"用中文回答用户问题"}]},{role:"user",content:[{type:"text",text:"你是端点科技医疗影像助手"}]}],J.success("重置成功")}return(i,t)=>{const s=D,d=I,k=N,v=B;return l(),o(u,null,[t[4]||(t[4]=m("div",{class:"title"},"医学影像",-1)),m("div",S,[n(v,{"label-width":"auto"},{default:r(()=>[n(d,{label:"操作"},{default:r(()=>[m("input",{type:"file",ref:"file",onChange:y,class:"file",accept:"image/*",multiple:""},null,544),n(s,{type:"primary",onClick:_},{default:r(()=>t[1]||(t[1]=[c("上传图片")])),_:1,__:[1]}),n(s,{type:"primary",onClick:x,loading:e.loading},{default:r(()=>t[2]||(t[2]=[c("提交")])),_:1,__:[2]},8,["loading"]),n(s,{type:"primary",onClick:h},{default:r(()=>t[3]||(t[3]=[c("重置")])),_:1,__:[3]})]),_:1}),e.images.length?(l(),w(d,{key:0,label:"影像",class:"imgitem"},{default:r(()=>[(l(!0),o(u,null,p(e.images,a=>(l(),o("span",T,[m("img",{src:a,height:"100",class:"img"},null,8,U)]))),256))]),_:1})):g("",!0),n(d,{label:"提示词"},{default:r(()=>[n(k,{modelValue:e.text,"onUpdate:modelValue":t[0]||(t[0]=a=>e.text=a),rows:5,type:"textarea",placeholder:"请输入症状用于智能导诊"},null,8,["modelValue"])]),_:1})]),_:1})]),m("div",z,[(l(!0),o(u,null,p(e.messages,a=>{var f;return l(),o("div",{class:V([{user:a.role==="user",assistant:a.role==="assistant"},"item"])},[(f=a.images)!=null&&f.length?(l(),o("div",A,[(l(!0),o(u,null,p(a.images,C=>(l(),o("span",G,[m("img",{src:C,height:"100",class:"img"},null,8,M)]))),256))])):g("",!0),c(" "+F(a.content),1)],2)}),256))])],64)}}},W=L(O,[["__scopeId","data-v-f6d20225"]]);export{W as default};
